(this["webpackJsonpstudents-manager"]=this["webpackJsonpstudents-manager"]||[]).push([[0],{20:function(e,t,a){e.exports=a(33)},25:function(e,t,a){},26:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),c=a.n(o),l=(a(25),a(26),a(7)),u=a(2),s=a.n(u),d=a(6),i=a(1),f=a(14),m=a(15),p=new(function(){function e(){Object(f.a)(this,e)}return Object(m.a)(e,[{key:"getModel",value:function(t,a){return new Promise((function(n,r){var o=e.db;if(o.hasOwnProperty(t)){var c=o[t].find((function(e){return e.id===a}));c?n(c):r("model not found")}else r("nature not found")}))}},{key:"getModels",value:function(t){return new Promise((function(a,n){var r=e.db;r.hasOwnProperty(t)?a(r[t]):n("nature not found")}))}},{key:"updateModel",value:function(t,a,n){return new Promise((function(r,o){var c=e.db;if(c.hasOwnProperty(t)){var l=void 0;c[t]=c[t].map((function(e){return e.id===a?l=Object(i.a)({},e,{},n):e})),l?(localStorage.setItem("database",JSON.stringify(c)),r(l)):o("model not found")}else o("nature not found")}))}},{key:"createModel",value:function(t,a){return new Promise((function(n,r){var o=e.db;if(o.hasOwnProperty(t)){var c=Object(i.a)({},a,{id:0}),l=o[t][o[t].length-1];void 0!==l&&(c.id=l.id+1),o[t].push(c),localStorage.setItem("database",JSON.stringify(o)),n(c)}else r("nature not found")}))}},{key:"delete",value:function(t,a){return new Promise((function(n,r){var o=e.db;o.hasOwnProperty(t)?(o[t]=o[t].filter((function(e){return e.id!==a})),localStorage.setItem("database",JSON.stringify(o)),n()):r("nature not found")}))}},{key:"initState",value:function(t){var a,n,r;return s.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:for(r in a=e.db,n=Object(i.a)({},a),t)a.hasOwnProperty(r)||(n=Object(i.a)({},n,Object(d.a)({},r,t[r])));localStorage.setItem("database",JSON.stringify(n));case 4:case"end":return o.stop()}}))}}],[{key:"db",get:function(){var e=localStorage.getItem("database");return null!=e?JSON.parse(e):{}}}]),e}());var v,E,b={fetchStudents:function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.awrap(p.getModels("students"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}))},createStudent:function(e){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(p.createModel("students",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))},updateStudent:function(e,t){return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(p.updateModel("students",e,t));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}))},deleteStudent:function(e){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(p.delete("students",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))}};function h(e){return{type:v.UpdateSuccess,payload:e}}function y(e){return{type:v.DeleteSuccess,payload:e}}function g(){return{type:v.ResetEditModel}}!function(e){e.Fetch="[Students] Fetch",e.FetchSuccess="[Students] Fetch Success",e.FetchError="[Students] Fetch Error",e.Create="[Students] Create",e.CreateSuccess="[Students] Create Success",e.CreateError="[Students] Create Error",e.Update="[Students] Update",e.UpdateSuccess="[Students] Update Success",e.UpdateError="[Students] Update Error",e.Delete="[Students] Delete",e.DeleteSuccess="[Students] Delete Success",e.DeleteError="[Students] Delete Error",e.StartEditModel="[Student] Start Edit Model",e.ResetEditModel="[Student] Reset Edit Model",e.ChangeEditModel="[Student] Change Edit Model"}(v||(v={})),function(e){e[e.UNSATISFACTORY=2]="UNSATISFACTORY",e[e.SATISFACTORY=3]="SATISFACTORY",e[e.WELL=4]="WELL",e[e.EXCELLENT=5]="EXCELLENT"}(E||(E={}));var S=[{id:E.UNSATISFACTORY,value:"\u041d\u0435\u0443\u0434"},{id:E.SATISFACTORY,value:"\u0423\u0434"},{id:E.WELL,value:"\u0425\u043e\u0440"},{id:E.EXCELLENT,value:"\u041e\u0442\u043b"}],w={id:0,fullName:"",birthday:"",progress:E.EXCELLENT};var O={loading:!1,students:[],form:{isNew:!0,model:w}},N=function(e){var t=S.find((function(t){return t.id==e.model.progress}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,e.model.id),r.a.createElement("td",null,e.model.fullName),r.a.createElement("td",null,e.model.birthday),r.a.createElement("td",null,t?t.value:""),r.a.createElement("td",null,r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"btn btn-warning",onClick:function(){e.update(e.model)}},"edit"),e.delete?r.a.createElement("button",{className:"btn btn-danger",onClick:function(){void 0!==e.delete&&e.delete()}},"delete"):"")))},j=a(18);function C(e,t){var a=e.hasOwnProperty(t)&&void 0!==e[t],n=[];return a||n.push("Property ".concat(t," is undefined")),a&&((a=!!e[t])||n.push("Property ".concat(t," is required"))),{valid:a,errors:n}}var x=function(e){return e.showError?!e.validation||e.validation.valid||e.validation.fields[e.field].valid?r.a.createElement("div",null):r.a.createElement("div",null,e.validation.fields[e.field].errors.map((function(e,t){return r.a.createElement("small",{key:t,className:"text-danger"},e)}))):r.a.createElement("div",null)};x.defaultProps={validation:void 0,field:"",showError:!0};var F=function(e){var t=Object(n.useState)({showErrors:!1}),a=Object(j.a)(t,2),o=a[0],c=a[1];function l(t,a){e.change(Object(d.a)({},t,a))}function u(){e.submit(e.isNew,e.model)}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!o.showErrors;c({showErrors:e})}var i=function(e,t){var a={valid:!0,fields:{}},n=!0,r=!1,o=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var u=c.value,s=!0,d=!1,i=void 0;try{for(var f,m=u.validators[Symbol.iterator]();!(s=(f=m.next()).done);s=!0){var p=(0,f.value)(e,u.field);a.valid=a.valid&&p.valid,a.fields[u.field]=p}}catch(v){d=!0,i=v}finally{try{s||null==m.return||m.return()}finally{if(d)throw i}}}}catch(v){r=!0,o=v}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return a}(e.model,[{field:"fullName",validators:[C]},{field:"birthday",validators:[C]},{field:"progress",validators:[C]}]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"student-fullName"},"FullName"),r.a.createElement("input",{type:"text",className:"form-control",id:"student-fullName",name:"fullName",value:e.model.fullName,required:!0,onChange:function(e){return l(e.target.name,e.target.value)}}),r.a.createElement(x,{field:"fullName",validation:i,showError:o.showErrors})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"student-birthday"},"Birthday"),r.a.createElement("input",{name:"birthday",type:"date",className:"form-control",value:e.model.birthday,required:!0,onChange:function(e){return l(e.target.name,e.target.value)}}),r.a.createElement(x,{field:"birthday",validation:i,showError:o.showErrors})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"student-progress"},"Progress"),r.a.createElement("select",{name:"progress",className:"form-control",value:e.model.progress,required:!0,onChange:function(e){return l(e.target.name,e.target.value)}},S.map((function(e){return r.a.createElement(r.a.Fragment,{key:e.id},r.a.createElement("option",{value:e.id},e.value))}))),r.a.createElement(x,{field:"progress",validation:i,showError:o.showErrors})),r.a.createElement("div",{className:"btn-group"},e.isNew&&r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){i.valid?(u(),s(!1)):s(!0)}},"Create"),!e.isNew&&r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){i.valid?(u(),s(!1)):s(!0)}},"Update"),r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){e.reset(),s(!1)}},"Reset"))))};F.defaultProps={isNew:!0,model:void 0};p.initState({students:[]}).then((function(){})).catch((function(e){}));var k=function(){var e=Object(l.c)((function(e){return e.students})),t=Object(l.b)();function a(e){var a;document.getElementById("formWrapper").focus(),t((a=e,{type:v.StartEditModel,payload:a}))}function o(e){t(function(e){return function(t){return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t({type:v.Delete}),a.prev=1,a.next=4,s.a.awrap(b.deleteStudent(e));case 4:t(y(e)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),t({type:v.DeleteError});case 10:case"end":return a.stop()}}),null,null,[[1,7]])}}(e))}return Object(n.useEffect)((function(){t((function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e({type:v.Fetch}),a.prev=1,a.next=4,s.a.awrap(b.fetchStudents());case 4:t=a.sent,e((n=t,{type:v.FetchSuccess,payload:n})),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),e({type:v.FetchError});case 11:case"end":return a.stop()}var n}),null,null,[[1,8]])}))}),[t]),r.a.createElement("div",{className:"pt-4 pb-4"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Students manager"),r.a.createElement("div",{className:"mb-3",id:"formWrapper"},r.a.createElement(F,{change:function(e){return t((a=e,{type:v.ChangeEditModel,payload:a}));var a},reset:function(){return t(g())},model:e.form.model,isNew:e.form.isNew,submit:function(e,a){var n,r;t(e?(r=a,function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e({type:v.Create}),a.prev=1,a.next=4,s.a.awrap(b.createStudent(r));case 4:t=a.sent,console.log(t),e((n=t,{type:v.CreateSuccess,payload:n})),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),e({type:v.CreateError});case 12:case"end":return a.stop()}var n}),null,null,[[1,9]])}):(n={id:a.id,student:a},function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e({type:v.Update}),a.prev=1,a.next=4,s.a.awrap(b.updateStudent(n.id,n.student));case 4:t=a.sent,e(h(t)),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),e({type:v.UpdateError});case 11:case"end":return a.stop()}}),null,null,[[1,8]])})),t(g())}})),r.a.createElement("table",{className:"table table-striped table-responsive-lg"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"id"),r.a.createElement("th",null,"FullName"),r.a.createElement("th",null,"Birthday"),r.a.createElement("th",null,"Progress"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,e.students.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement(N,{model:e,delete:function(){return o(e.id)},update:function(e){return a(e)}}))}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var M=a(4),P=a(16),T=a(19);var U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.Fetch:return Object(i.a)({},e,{loading:!0});case v.FetchSuccess:return Object(i.a)({},e,{students:t.payload,loading:!1});case v.FetchError:return Object(i.a)({},e,{loading:!1});case v.Create:return Object(i.a)({},e,{loading:!0});case v.CreateSuccess:return Object(i.a)({},e,{students:[].concat(Object(T.a)(e.students),[t.payload]),loading:!1});case v.CreateError:return Object(i.a)({},e,{loading:!1});case v.Update:return Object(i.a)({},e,{loading:!0});case v.UpdateSuccess:return Object(i.a)({},e,{students:e.students.map((function(e){return e.id===t.payload.id?Object(i.a)({},e,{},t.payload):e})),loading:!1});case v.UpdateError:return Object(i.a)({},e,{loading:!1});case v.Delete:return Object(i.a)({},e,{loading:!0});case v.DeleteSuccess:return Object(i.a)({},e,{students:e.students.filter((function(e){return e.id!==t.payload})),loading:!1});case v.DeleteError:return Object(i.a)({},e,{loading:!1});case v.StartEditModel:return Object(i.a)({},e,{form:Object(i.a)({},e.form,{isNew:!1,model:t.payload})});case v.ResetEditModel:return Object(i.a)({},e,{form:Object(i.a)({},e.form,{isNew:!0,model:w})});case v.ChangeEditModel:return Object(i.a)({},e,{form:Object(i.a)({},e.form,{model:Object(i.a)({},e.form.model,{},t.payload)})});default:return e}},L=a(17),A=Object(M.combineReducers)({students:U}),D=Object(M.createStore)(A,Object(P.composeWithDevTools)(Object(M.applyMiddleware)(L.a)));c.a.render(r.a.createElement(l.a,{store:D},r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.1e0f84b7.chunk.js.map